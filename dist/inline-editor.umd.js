(function(N,n){typeof exports=="object"&&typeof module<"u"?n(exports,require("react"),require("react-hot-toast"),require("lucide-react"),require("framer-motion")):typeof define=="function"&&define.amd?define(["exports","react","react-hot-toast","lucide-react","framer-motion"],n):(N=typeof globalThis<"u"?globalThis:N||self,n(N.CryptonicInlineEditor={},N.React,N.ReactHotToast,N.LucideReact,N.FramerMotion))})(this,function(N,n,ee,oe,se){"use strict";var Qt=Object.defineProperty;var er=(N,n,ee)=>n in N?Qt(N,n,{enumerable:!0,configurable:!0,writable:!0,value:ee}):N[n]=ee;var fe=(N,n,ee)=>er(N,typeof n!="symbol"?n+"":n,ee);var Se={exports:{}},pe={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var De;function st(){if(De)return pe;De=1;var c=n,e=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,l=c.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function a(m,f,d){var g,b={},P=null,k=null;d!==void 0&&(P=""+d),f.key!==void 0&&(P=""+f.key),f.ref!==void 0&&(k=f.ref);for(g in f)o.call(f,g)&&!u.hasOwnProperty(g)&&(b[g]=f[g]);if(m&&m.defaultProps)for(g in f=m.defaultProps,f)b[g]===void 0&&(b[g]=f[g]);return{$$typeof:e,type:m,key:P,ref:k,props:b,_owner:l.current}}return pe.Fragment=r,pe.jsx=a,pe.jsxs=a,pe}var ge={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Oe;function at(){return Oe||(Oe=1,process.env.NODE_ENV!=="production"&&function(){var c=n,e=Symbol.for("react.element"),r=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),u=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),m=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),g=Symbol.for("react.suspense_list"),b=Symbol.for("react.memo"),P=Symbol.for("react.lazy"),k=Symbol.for("react.offscreen"),$=Symbol.iterator,V="@@iterator";function D(t){if(t===null||typeof t!="object")return null;var s=$&&t[$]||t[V];return typeof s=="function"?s:null}var z=c.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function v(t){{for(var s=arguments.length,p=new Array(s>1?s-1:0),j=1;j<s;j++)p[j-1]=arguments[j];W("error",t,p)}}function W(t,s,p){{var j=z.ReactDebugCurrentFrame,L=j.getStackAddendum();L!==""&&(s+="%s",p=p.concat([L]));var F=p.map(function(A){return String(A)});F.unshift("Warning: "+s),Function.prototype.apply.call(console[t],console,F)}}var I=!1,G=!1,X=!1,E=!1,y=!1,O;O=Symbol.for("react.module.reference");function x(t){return!!(typeof t=="string"||typeof t=="function"||t===o||t===u||y||t===l||t===d||t===g||E||t===k||I||G||X||typeof t=="object"&&t!==null&&(t.$$typeof===P||t.$$typeof===b||t.$$typeof===a||t.$$typeof===m||t.$$typeof===f||t.$$typeof===O||t.getModuleId!==void 0))}function w(t,s,p){var j=t.displayName;if(j)return j;var L=s.displayName||s.name||"";return L!==""?p+"("+L+")":p}function T(t){return t.displayName||"Context"}function h(t){if(t==null)return null;if(typeof t.tag=="number"&&v("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case o:return"Fragment";case r:return"Portal";case u:return"Profiler";case l:return"StrictMode";case d:return"Suspense";case g:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case m:var s=t;return T(s)+".Consumer";case a:var p=t;return T(p._context)+".Provider";case f:return w(t,t.render,"ForwardRef");case b:var j=t.displayName||null;return j!==null?j:h(t.type)||"Memo";case P:{var L=t,F=L._payload,A=L._init;try{return h(A(F))}catch{return null}}}return null}var R=Object.assign,C=0,H,M,U,q,Z,S,B;function re(){}re.__reactDisabledLog=!0;function qe(){{if(C===0){H=console.log,M=console.info,U=console.warn,q=console.error,Z=console.group,S=console.groupCollapsed,B=console.groupEnd;var t={configurable:!0,enumerable:!0,value:re,writable:!0};Object.defineProperties(console,{info:t,log:t,warn:t,error:t,group:t,groupCollapsed:t,groupEnd:t})}C++}}function Tt(){{if(C--,C===0){var t={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:R({},t,{value:H}),info:R({},t,{value:M}),warn:R({},t,{value:U}),error:R({},t,{value:q}),group:R({},t,{value:Z}),groupCollapsed:R({},t,{value:S}),groupEnd:R({},t,{value:B})})}C<0&&v("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var je=z.ReactCurrentDispatcher,Te;function ye(t,s,p){{if(Te===void 0)try{throw Error()}catch(L){var j=L.stack.trim().match(/\n( *(at )?)/);Te=j&&j[1]||""}return`
`+Te+t}}var _e=!1,we;{var _t=typeof WeakMap=="function"?WeakMap:Map;we=new _t}function Be(t,s){if(!t||_e)return"";{var p=we.get(t);if(p!==void 0)return p}var j;_e=!0;var L=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var F;F=je.current,je.current=null,qe();try{if(s){var A=function(){throw Error()};if(Object.defineProperty(A.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(A,[])}catch(te){j=te}Reflect.construct(t,[],A)}else{try{A.call()}catch(te){j=te}t.call(A.prototype)}}else{try{throw Error()}catch(te){j=te}t()}}catch(te){if(te&&j&&typeof te.stack=="string"){for(var _=te.stack.split(`
`),Q=j.stack.split(`
`),Y=_.length-1,J=Q.length-1;Y>=1&&J>=0&&_[Y]!==Q[J];)J--;for(;Y>=1&&J>=0;Y--,J--)if(_[Y]!==Q[J]){if(Y!==1||J!==1)do if(Y--,J--,J<0||_[Y]!==Q[J]){var ne=`
`+_[Y].replace(" at new "," at ");return t.displayName&&ne.includes("<anonymous>")&&(ne=ne.replace("<anonymous>",t.displayName)),typeof t=="function"&&we.set(t,ne),ne}while(Y>=1&&J>=0);break}}}finally{_e=!1,je.current=F,Tt(),Error.prepareStackTrace=L}var de=t?t.displayName||t.name:"",le=de?ye(de):"";return typeof t=="function"&&we.set(t,le),le}function Ut(t,s,p){return Be(t,!1)}function At(t){var s=t.prototype;return!!(s&&s.isReactComponent)}function Ee(t,s,p){if(t==null)return"";if(typeof t=="function")return Be(t,At(t));if(typeof t=="string")return ye(t);switch(t){case d:return ye("Suspense");case g:return ye("SuspenseList")}if(typeof t=="object")switch(t.$$typeof){case f:return Ut(t.render);case b:return Ee(t.type,s,p);case P:{var j=t,L=j._payload,F=j._init;try{return Ee(F(L),s,p)}catch{}}}return""}var be=Object.prototype.hasOwnProperty,He={},Ye=z.ReactDebugCurrentFrame;function Ce(t){if(t){var s=t._owner,p=Ee(t.type,t._source,s?s.type:null);Ye.setExtraStackFrame(p)}else Ye.setExtraStackFrame(null)}function It(t,s,p,j,L){{var F=Function.call.bind(be);for(var A in t)if(F(t,A)){var _=void 0;try{if(typeof t[A]!="function"){var Q=Error((j||"React class")+": "+p+" type `"+A+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof t[A]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw Q.name="Invariant Violation",Q}_=t[A](s,A,j,p,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(Y){_=Y}_&&!(_ instanceof Error)&&(Ce(L),v("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",j||"React class",p,A,typeof _),Ce(null)),_ instanceof Error&&!(_.message in He)&&(He[_.message]=!0,Ce(L),v("Failed %s type: %s",p,_.message),Ce(null))}}}var Pt=Array.isArray;function Ue(t){return Pt(t)}function $t(t){{var s=typeof Symbol=="function"&&Symbol.toStringTag,p=s&&t[Symbol.toStringTag]||t.constructor.name||"Object";return p}}function Dt(t){try{return Ke(t),!1}catch{return!0}}function Ke(t){return""+t}function Je(t){if(Dt(t))return v("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",$t(t)),Ke(t)}var Ge=z.ReactCurrentOwner,Ot={key:!0,ref:!0,__self:!0,__source:!0},Xe,Ze;function zt(t){if(be.call(t,"ref")){var s=Object.getOwnPropertyDescriptor(t,"ref").get;if(s&&s.isReactWarning)return!1}return t.ref!==void 0}function Mt(t){if(be.call(t,"key")){var s=Object.getOwnPropertyDescriptor(t,"key").get;if(s&&s.isReactWarning)return!1}return t.key!==void 0}function Lt(t,s){typeof t.ref=="string"&&Ge.current}function Rt(t,s){{var p=function(){Xe||(Xe=!0,v("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",s))};p.isReactWarning=!0,Object.defineProperty(t,"key",{get:p,configurable:!0})}}function Ft(t,s){{var p=function(){Ze||(Ze=!0,v("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",s))};p.isReactWarning=!0,Object.defineProperty(t,"ref",{get:p,configurable:!0})}}var Nt=function(t,s,p,j,L,F,A){var _={$$typeof:e,type:t,key:s,ref:p,props:A,_owner:F};return _._store={},Object.defineProperty(_._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(_,"_self",{configurable:!1,enumerable:!1,writable:!1,value:j}),Object.defineProperty(_,"_source",{configurable:!1,enumerable:!1,writable:!1,value:L}),Object.freeze&&(Object.freeze(_.props),Object.freeze(_)),_};function Wt(t,s,p,j,L){{var F,A={},_=null,Q=null;p!==void 0&&(Je(p),_=""+p),Mt(s)&&(Je(s.key),_=""+s.key),zt(s)&&(Q=s.ref,Lt(s,L));for(F in s)be.call(s,F)&&!Ot.hasOwnProperty(F)&&(A[F]=s[F]);if(t&&t.defaultProps){var Y=t.defaultProps;for(F in Y)A[F]===void 0&&(A[F]=Y[F])}if(_||Q){var J=typeof t=="function"?t.displayName||t.name||"Unknown":t;_&&Rt(A,J),Q&&Ft(A,J)}return Nt(t,_,Q,L,j,Ge.current,A)}}var Ae=z.ReactCurrentOwner,Qe=z.ReactDebugCurrentFrame;function ue(t){if(t){var s=t._owner,p=Ee(t.type,t._source,s?s.type:null);Qe.setExtraStackFrame(p)}else Qe.setExtraStackFrame(null)}var Ie;Ie=!1;function Pe(t){return typeof t=="object"&&t!==null&&t.$$typeof===e}function et(){{if(Ae.current){var t=h(Ae.current.type);if(t)return`

Check the render method of \``+t+"`."}return""}}function Vt(t){return""}var tt={};function qt(t){{var s=et();if(!s){var p=typeof t=="string"?t:t.displayName||t.name;p&&(s=`

Check the top-level render call using <`+p+">.")}return s}}function rt(t,s){{if(!t._store||t._store.validated||t.key!=null)return;t._store.validated=!0;var p=qt(s);if(tt[p])return;tt[p]=!0;var j="";t&&t._owner&&t._owner!==Ae.current&&(j=" It was passed a child from "+h(t._owner.type)+"."),ue(t),v('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',p,j),ue(null)}}function nt(t,s){{if(typeof t!="object")return;if(Ue(t))for(var p=0;p<t.length;p++){var j=t[p];Pe(j)&&rt(j,s)}else if(Pe(t))t._store&&(t._store.validated=!0);else if(t){var L=D(t);if(typeof L=="function"&&L!==t.entries)for(var F=L.call(t),A;!(A=F.next()).done;)Pe(A.value)&&rt(A.value,s)}}}function Bt(t){{var s=t.type;if(s==null||typeof s=="string")return;var p;if(typeof s=="function")p=s.propTypes;else if(typeof s=="object"&&(s.$$typeof===f||s.$$typeof===b))p=s.propTypes;else return;if(p){var j=h(s);It(p,t.props,"prop",j,t)}else if(s.PropTypes!==void 0&&!Ie){Ie=!0;var L=h(s);v("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",L||"Unknown")}typeof s.getDefaultProps=="function"&&!s.getDefaultProps.isReactClassApproved&&v("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function Ht(t){{for(var s=Object.keys(t.props),p=0;p<s.length;p++){var j=s[p];if(j!=="children"&&j!=="key"){ue(t),v("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",j),ue(null);break}}t.ref!==null&&(ue(t),v("Invalid attribute `ref` supplied to `React.Fragment`."),ue(null))}}var ot={};function it(t,s,p,j,L,F){{var A=x(t);if(!A){var _="";(t===void 0||typeof t=="object"&&t!==null&&Object.keys(t).length===0)&&(_+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var Q=Vt();Q?_+=Q:_+=et();var Y;t===null?Y="null":Ue(t)?Y="array":t!==void 0&&t.$$typeof===e?(Y="<"+(h(t.type)||"Unknown")+" />",_=" Did you accidentally export a JSX literal instead of a component?"):Y=typeof t,v("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",Y,_)}var J=Wt(t,s,p,L,F);if(J==null)return J;if(A){var ne=s.children;if(ne!==void 0)if(j)if(Ue(ne)){for(var de=0;de<ne.length;de++)nt(ne[de],t);Object.freeze&&Object.freeze(ne)}else v("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else nt(ne,t)}if(be.call(s,"key")){var le=h(t),te=Object.keys(s).filter(function(Zt){return Zt!=="key"}),$e=te.length>0?"{key: someKey, "+te.join(": ..., ")+": ...}":"{key: someKey}";if(!ot[le+$e]){var Xt=te.length>0?"{"+te.join(": ..., ")+": ...}":"{}";v(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,$e,le,Xt,le),ot[le+$e]=!0}}return t===o?Ht(J):Bt(J),J}}function Yt(t,s,p){return it(t,s,p,!0)}function Kt(t,s,p){return it(t,s,p,!1)}var Jt=Kt,Gt=Yt;ge.Fragment=o,ge.jsx=Jt,ge.jsxs=Gt}()),ge}process.env.NODE_ENV==="production"?Se.exports=st():Se.exports=at();var i=Se.exports;class ie{static detect(){const e=this.getFromUrl();if(e)return this.save(e),this.cleanUrl(),console.info("[MagicToken] Token detected in URL and saved."),e;const r=this.get();return r?console.info("[MagicToken] Token loaded from localStorage."):console.warn("[MagicToken] No token found in URL or localStorage."),r}static getFromUrl(){const r=new URLSearchParams(window.location.search).get(this.URL_PARAM);return r&&this.isValidFormat(r)?(console.debug("[MagicToken] Token found in URL param."),r):(r&&console.warn("[MagicToken] Token in URL param is not a valid JWT format."),null)}static cleanUrl(){const e=new URL(window.location.href);e.searchParams.has(this.URL_PARAM)&&(e.searchParams.delete(this.URL_PARAM),window.history.replaceState({},"",e.toString()),console.debug("[MagicToken] magic_token param removed from URL."))}static isValidFormat(e){const r=e.split(".").length===3;return r||console.error("[MagicToken] Invalid token format (not JWT-like)."),r}static save(e){if(!this.isValidFormat(e)){console.error("[MagicToken] Refused to save invalid token.");return}localStorage.setItem(this.STORAGE_KEY,e),console.info("[MagicToken] Token saved in localStorage.")}static get(){const e=localStorage.getItem(this.STORAGE_KEY);return console.debug(e?"[MagicToken] get() -> token found.":"[MagicToken] get() -> no token found."),e}static clear(){localStorage.removeItem(this.STORAGE_KEY),console.info("[MagicToken] Token cleared from localStorage.")}static exists(){const e=!!this.get();return console.debug(`[MagicToken] exists() -> ${e}`),e}static parsePayload(e){try{const[,r]=e.split("."),o=JSON.parse(atob(r));return console.debug("[MagicToken] Payload parsed:",o),o}catch(r){return console.error("[MagicToken] Failed to parse payload:",r),null}}static isExpired(e){const r=this.parsePayload(e);if(!(r!=null&&r.exp))return console.warn("[MagicToken] No exp claim in token, treating as expired."),!0;const o=Date.now()>=r.exp*1e3;return o?console.warn("[MagicToken] Token is expired."):console.debug("[MagicToken] Token is valid (not expired)."),o}}fe(ie,"STORAGE_KEY","inline_editor_token"),fe(ie,"URL_PARAM","magic_token");const ze=n.createContext(null),ae=()=>{const c=n.useContext(ze);if(!c)throw new Error("useAuth must be used within AuthProvider");return c},lt=({children:c})=>{const[e,r]=n.useState(!1),[o,l]=n.useState(null),u="https://api.example.com";n.useEffect(()=>{(async()=>{console.group("[AuthProvider] Init auth");const g=ie.detect();if(!g){console.warn("[AuthProvider] No token detected. User is not authenticated."),r(!1),l(null),console.groupEnd();return}if(ie.isExpired(g)){console.warn("[AuthProvider] Token is expired. Clearing..."),ie.clear(),r(!1),l(null),console.groupEnd();return}try{console.info("[AuthProvider] Token is valid. Fetching user info...");const b=await m(g);b?(r(!0),l(b),console.info("[AuthProvider] User authenticated:",b)):(r(!1),l(null),console.warn("[AuthProvider] Token valid but user fetch failed."))}catch(b){r(!1),l(null),console.error("[AuthProvider] Error fetching user:",b)}console.groupEnd()})()},[]);const a=()=>{ie.clear(),r(!1),l(null),console.info("[AuthProvider] User logged out.")},m=async d=>{try{const g=await fetch(`${u}/wp-json/wp/v2/users/me`,{headers:{Authorization:`Bearer ${d}`}});if(!g.ok)return console.warn("[AuthProvider] fetchUser: API responded",g.status),null;const b=await g.json();return console.debug("[AuthProvider] fetchUser: API returned",b),b}catch(g){return console.error("[AuthProvider] fetchUser: Error",g),null}},f={isAuthenticated:e,user:o,logout:a};return i.jsx(ze.Provider,{value:f,children:c})},Me=n.createContext(null),he=()=>{const c=n.useContext(Me);if(!c)throw new Error("useNotifications must be used within NotificationProvider");return c},ve=({type:c,message:e,icon:r})=>i.jsxs("div",{className:`
    flex items-center gap-3 p-4 rounded-xl shadow-lg backdrop-blur-md border
    ${c==="success"?"bg-emerald-50/90 border-emerald-200 text-emerald-800":""}
    ${c==="error"?"bg-red-50/90 border-red-200 text-red-800":""}
    ${c==="warning"?"bg-amber-50/90 border-amber-200 text-amber-800":""}
    ${c==="info"?"bg-blue-50/90 border-blue-200 text-blue-800":""}
    transition-all duration-300 ease-out
  `,children:[i.jsx(r,{size:20,className:`
      ${c==="success"?"text-emerald-600":""}
      ${c==="error"?"text-red-600":""}
      ${c==="warning"?"text-amber-600":""}
      ${c==="info"?"text-blue-600":""}
    `}),i.jsx("span",{className:"font-medium text-sm",children:e})]}),ct=({children:c})=>{const f={success:(d,g)=>{ee.custom(i.jsx(ve,{type:"success",message:d,icon:oe.CheckCircle}),{duration:4e3,position:"top-right",...g})},error:(d,g)=>{ee.custom(i.jsx(ve,{type:"error",message:d,icon:oe.XCircle}),{duration:6e3,position:"top-right",...g})},warning:(d,g)=>{ee.custom(i.jsx(ve,{type:"warning",message:d,icon:oe.AlertCircle}),{duration:5e3,position:"top-right",...g})},info:(d,g)=>{ee.custom(i.jsx(ve,{type:"info",message:d,icon:oe.Info}),{duration:4e3,position:"top-right",...g})},loading:(d,g)=>ee.loading(d,{position:"top-right",style:{background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(12px)",border:"1px solid rgba(0, 0, 0, 0.1)",borderRadius:"12px",color:"#374151",fontWeight:"500",fontSize:"14px"},...g}),dismiss:d=>{d?ee.dismiss(d):ee.dismiss()},promise:(d,g)=>ee.promise(d,g,{position:"top-right",style:{background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(12px)",border:"1px solid rgba(0, 0, 0, 0.1)",borderRadius:"12px",fontWeight:"500",fontSize:"14px"},success:{style:{background:"rgba(16, 185, 129, 0.1)",border:"1px solid rgba(16, 185, 129, 0.3)",color:"#065f46"}},error:{style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",color:"#991b1b"}}})};return i.jsxs(Me.Provider,{value:f,children:[c,i.jsx(ee.Toaster,{position:"top-right",gutter:12,containerStyle:{top:80,right:20},toastOptions:{duration:4e3,style:{background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(12px)",border:"1px solid rgba(0, 0, 0, 0.1)",borderRadius:"12px",color:"#374151",fontWeight:"500",fontSize:"14px",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)"}}})]})};function ut(c,e){const r=n.useRef();return n.useCallback((...o)=>{r.current&&clearTimeout(r.current),r.current=window.setTimeout(()=>{c(...o)},e)},[c,e])}class ke{constructor(e){fe(this,"baseUrl");fe(this,"config",{timeout:3e4,maxRetries:3,retryDelay:1e3});this.baseUrl=(e||void 0||"https://www.wow.cryptonic-drinks.com").replace(/\/+$/,""),console.log("[ApiService] Initialized with base URL:",this.baseUrl)}getAuthToken(){return localStorage.getItem("inline_editor_token")}getHeaders(e=!1){const r={"Content-Type":"application/json"};if(e){const o=this.getAuthToken();o&&(r.Authorization=`Bearer ${o}`)}return r}async fetchWithTimeout(e,r){const o=new AbortController,l=setTimeout(()=>o.abort(),this.config.timeout);try{const u=await fetch(e,{...r,signal:o.signal});return clearTimeout(l),u}catch(u){throw clearTimeout(l),u instanceof Error&&u.name==="AbortError"?new Error("Request timeout"):u}}async fetchWithRetry(e,r={},o=this.config.maxRetries){let l=null;for(let u=0;u<o;u++)try{const a=await this.fetchWithTimeout(e,{...r,headers:{...this.getHeaders(),...r.headers}});if(!a.ok){const f=new Error(`HTTP ${a.status}: ${a.statusText}`);if(f.status=a.status,a.status>=400&&a.status<500)throw f;l=f;continue}return await a.json()}catch(a){if(l=a,a instanceof SyntaxError||a instanceof Error&&"status"in a&&a.status>=400&&a.status<500)throw a;if(u<o-1){const m=this.config.retryDelay*Math.pow(2,u);console.log(`[ApiService] Retry attempt ${u+1}/${o} after ${m}ms`),await new Promise(f=>setTimeout(f,m))}}throw l||new Error("Request failed after all retries")}async loadAllContents(){console.log("[ApiService] Loading all contents from:",`${this.baseUrl}/wp-json/api/editable-content`);try{const e=await this.fetchWithRetry(`${this.baseUrl}/wp-json/api/editable-content`,{headers:this.getHeaders(!0)});if(!Array.isArray(e))throw new Error("Invalid response format: expected array");const r=e.filter(o=>o.context&&o.context_id).map(o=>({editable_id:o.editable_id,content:o.content||"",context:o.context,context_id:o.context_id,version:o.version||0,contentType:o.content_type||"text",lastModified:Date.now()}));return console.log(`[ApiService] Loaded ${r.length} contents`),r}catch(e){throw console.error("[ApiService] Failed to load contents:",e),this.handleApiError(e)}}async saveContent(e,r){if(console.log("[ApiService] Saving content to:",`${this.baseUrl}/wp-json/api/editable-content/save`),console.log("[ApiService] Content context_id:",e.context_id),console.log("[ApiService] User edited content:",e.content),console.log("[ApiService] Default content (for reference):",r),!this.getAuthToken())throw new Error("Authentication required for saving content");if(!e.context||!e.context_id)throw new Error("Context and context_id are required");const l=!e.editable_id&&!e.version&&r!==void 0,u={content:e.content,context:e.context,context_id:e.context_id,content_type:e.contentType||"text"};e.version&&(u.version=e.version),l&&(u.isDefaultContent=!0,u.defaultContent=r),console.log("[ApiService] Request body:",u);try{const a=await this.fetchWithRetry(`${this.baseUrl}/wp-json/api/editable-content/save`,{method:"POST",headers:this.getHeaders(!0),body:JSON.stringify(u)});switch(console.log("[ApiService] Save response:",a),a.status){case"success":case"no_action":case"no_change":if(!a.data)throw new Error("No data returned from save operation");return{content:{...e,editable_id:a.data.editable_id,content:a.data.content,version:a.data.version,contentType:a.data.content_type,lastModified:Date.now()},status:a.status,message:a.message};case"conflict":throw a.conflict?Object.assign(new Error(a.message),{type:"VERSION_CONFLICT",conflict:a.conflict}):new Error("Conflict response missing conflict data");case"error":default:throw new Error(a.message||"Save operation failed")}}catch(a){throw console.error("[ApiService] Save failed:",a),this.handleApiError(a)}}handleApiError(e){return e instanceof Error?"type"in e&&e.type==="VERSION_CONFLICT"?e:e.message==="Request timeout"?new Error("La requête a expiré. Vérifiez votre connexion internet."):"status"in e&&e.status===401?new Error("Session expirée. Veuillez vous reconnecter."):"status"in e&&e.status===403?new Error("Vous n'avez pas les permissions nécessaires."):e:new Error("Une erreur inattendue s'est produite")}isAuthenticated(){return!!this.getAuthToken()}async testConnection(){try{return await this.fetchWithRetry(`${this.baseUrl}/wp-json/api/editable-content`,{method:"HEAD"},1),!0}catch{return!1}}static isVersionConflictError(e){return e instanceof Error&&"type"in e&&e.type==="VERSION_CONFLICT"&&"conflict"in e}static getConflictInfo(e){return this.isVersionConflictError(e)?e.conflict:null}async getContentByContext(e,r){console.log("[ApiService] Getting content by context:",e,r);try{const o=new URLSearchParams({context:e,context_id:r}),l=await this.fetchWithRetry(`${this.baseUrl}/wp-json/api/editable-content/get?${o.toString()}`,{headers:this.getHeaders(!1)});return l.exists?{editable_id:l.editable_id,content:l.content||"",context:l.context,context_id:l.context_id,version:l.version||0,contentType:l.content_type||"text",lastModified:l.updated_at?new Date(l.updated_at).getTime():Date.now()}:null}catch(o){throw console.error("[ApiService] Failed to get content by context:",o),this.handleApiError(o)}}clearAuthToken(){console.log("[ApiService] Auth token cleared")}static isAuthError(e){return e instanceof Error&&"status"in e&&e.status===401}static isPermissionError(e){return e instanceof Error&&"status"in e&&e.status===403}getStats(){return{totalRequests:0,failedRequests:0,avgResponseTime:0}}getConfig(){return{baseUrl:this.baseUrl,timeout:this.config.timeout,maxRetries:this.config.maxRetries}}}const Le=n.createContext(null),me=()=>{const c=n.useContext(Le);if(!c)throw new Error("useContent must be used within ContentProvider");return c},dt=({children:c,apiBaseUrl:e,onVersionConflict:r})=>{const{isAuthenticated:o}=ae(),{error:l,warning:u,promise:a}=he(),[m,f]=n.useState(!0),[d,g]=n.useState({}),b=n.useRef(new Map),P=5*60*1e3,k=e||void 0,[$]=n.useState(()=>new ke(k)),V=ut(async(x,w)=>await I(x,w),500),D=n.useCallback((x,w)=>{if(!(x!=null&&x.trim())||!(w!=null&&w.trim()))throw new Error("Context and contextId are required and cannot be empty");return`${x}#${w}`},[]),z=n.useCallback(x=>{const w=b.current.get(x);return w&&Date.now()-w.timestamp<P?w.content:(b.current.delete(x),null)},[]),v=n.useCallback((x,w)=>{b.current.set(x,{content:w,timestamp:Date.now()})},[]),W=n.useCallback((x,w,T)=>{if(!(x!=null&&x.trim())||!(w!=null&&w.trim()))return console.warn("[ContentProvider] getContent called with empty context or contextId"),T;try{const h=D(x,w),R=z(h);if(R)return R.content;const C=d[h];return C?(v(h,C),C.content):T}catch(h){return console.error("[ContentProvider] Error in getContent:",h),T}},[d,D,z,v]),I=n.useCallback(async(x,w)=>{var R,C;if(!((R=x.context)!=null&&R.trim())||!((C=x.context_id)!=null&&C.trim()))return console.error("[ContentProvider] Cannot save: context and context_id are required"),l("Invalid content configuration"),!1;if(!o)return console.error("[ContentProvider] Cannot save: authentication required"),u("Please log in to save changes"),!1;const T=D(x.context,x.context_id),h=d[T];try{const H={...x,lastModified:Date.now()};g(q=>({...q,[T]:H})),v(T,H);const M={...x,...h&&{editable_id:h.editable_id,version:h.version}},U=await $.saveContent(M,!h&&w!==void 0?w:void 0);switch(U.status){case"success":case"no_action":const q=U.content;return g(Z=>({...Z,[T]:q})),v(T,q),!0;case"no_change":return u("No changes detected"),!0;default:throw new Error(`Unexpected status: ${U.status}`)}}catch(H){if(console.error("[ContentProvider] Save failed:",H),g(M=>{const U={...M};return h?(U[T]=h,v(T,h)):(delete U[T],b.current.delete(T)),U}),ke.isVersionConflictError(H)){const M=ke.getConflictInfo(H);if(M&&r)switch(await r({clientVersion:M.client_version,serverVersion:M.server_version,serverContent:M.server_content,clientContent:x.content})){case"overwrite":const q={...x,version:M.server_version,editable_id:M.editable_id};return I(q);case"keep_server":const Z={...x,content:M.server_content,version:M.server_version,editable_id:M.editable_id,lastModified:Date.now()};return g(S=>({...S,[T]:Z})),v(T,Z),u("Using server version of content"),!1;case"cancel":default:return u("Save cancelled"),!1}else l("Content was modified by another user. Please refresh to get the latest version.")}return!1}},[o,D,$,d,r,l,u,v]),G=n.useCallback(async(x,w)=>V(x,w),[V]),X=n.useCallback(x=>{const w={};for(const T of x)if(T.context&&T.context_id){const h=D(T.context,T.context_id);w[h]=T}return w},[D]),E=n.useCallback(async()=>{try{const x=await $.loadAllContents(),w=X(x);g(w),Object.entries(w).forEach(([T,h])=>{v(T,h)}),Object.keys(w).length>0&&o&&console.log(`[ContentProvider] Successfully loaded ${Object.keys(w).length} editable contents`)}catch(x){throw console.error("[ContentProvider] Failed to load contents:",x),l("Failed to load content. Please refresh the page."),x}},[$,X,l,o,v]);n.useEffect(()=>{(async()=>{f(!0);try{await E()}catch(w){console.error("[ContentProvider] Initialization failed:",w)}finally{f(!1)}})()},[o,E]);const y=n.useCallback(async()=>{f(!0);try{await a(E(),{loading:"Refreshing content...",success:"Content refreshed successfully!",error:"Failed to refresh content"})}finally{f(!1)}},[E,a]),O={isLoading:m,contents:d,getContent:W,saveContent:G,refreshContents:y};return i.jsx(Le.Provider,{value:O,children:c})},ft=()=>{const[c,e]=n.useState(!1);return null},pt=({content:c,onSave:e,onCancel:r,config:o,className:l="",style:u={},as:a="span"})=>{const[m,f]=n.useState(!1),[d,g]=n.useState(!1),b=n.useRef(null),P=n.useRef(c),{success:k,error:$,loading:V,dismiss:D}=he();n.useEffect(()=>{if(b.current){b.current.focus();const E=document.createRange(),y=window.getSelection();E.selectNodeContents(b.current),E.collapse(!1),y==null||y.removeAllRanges(),y==null||y.addRange(E)}},[]);const z=n.useCallback(()=>b.current&&b.current.innerText||"",[]),v=n.useCallback(()=>{const E=z();g(E!==P.current)},[z]),W=n.useCallback(E=>{E.key==="Escape"?(E.preventDefault(),r()):((E.ctrlKey||E.metaKey)&&E.key==="Enter"||(E.ctrlKey||E.metaKey)&&E.key==="s")&&(E.preventDefault(),I()),!o.multiline&&E.key==="Enter"&&E.preventDefault()},[r,o.multiline]),I=n.useCallback(async()=>{const E=z();if(m)return;if(E===P.current){k("No changes to save"),r();return}f(!0);const y=V("Saving changes...");try{const O=await e(E);D(y),O?(k("Changes saved successfully"),P.current=E,g(!1)):$("Failed to save changes")}catch(O){D(y),$("An error occurred while saving"),console.error("[ModernInlineTextEditor] Save error:",O)}finally{f(!1)}},[z,e,m,k,$,V,D,r]),G=n.useCallback(E=>{E.preventDefault();const y=E.clipboardData.getData("text/plain"),O=o.multiline?y:y.replace(/\n/g," ");document.execCommand("insertText",!1,O),v()},[o.multiline,v]),X=n.useCallback(E=>{const y=E.relatedTarget;y!=null&&y.closest(".inline-editor-actions-modern")||d&&!m&&I()},[d,m,I]);return i.jsxs("div",{className:"inline-editor-container-modern",children:[i.jsx("div",{ref:b,contentEditable:!0,suppressContentEditableWarning:!0,onKeyDown:W,onPaste:G,onBlur:X,onInput:v,className:`inline-editor-content-modern ${l}`,style:{...u,outline:"none",border:"none",background:"transparent",minHeight:"inherit",minWidth:"inherit",display:"inherit",fontFamily:"inherit",fontSize:"inherit",fontWeight:"inherit",lineHeight:"inherit",color:"inherit",textAlign:"inherit",textDecoration:"inherit",textTransform:"inherit",letterSpacing:"inherit",wordSpacing:"inherit",margin:"0",padding:"0"},"data-placeholder":o.placeholder||"Enter text...",role:"textbox","aria-label":`Edit ${o.id}`,"aria-multiline":o.multiline,children:c}),i.jsxs("div",{className:"inline-editor-actions-modern",style:{position:"absolute",top:"-2.5rem",right:"0",display:"flex",gap:"0.25rem",zIndex:1e3,opacity:d||m?1:.7},children:[i.jsx("button",{onClick:I,disabled:m||!d,className:"inline-editor-btn-modern save",title:`Save changes ${o.multiline?"(Ctrl+Enter)":"(Enter)"}`,onMouseDown:E=>E.preventDefault(),style:{width:"1.75rem",height:"1.75rem",background:d?"#10b981":"#6b7280",color:"white",border:"none",borderRadius:"0.375rem",cursor:m||!d?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",opacity:m||!d?.6:1},"aria-label":"Save changes",children:m?i.jsx(oe.Loader2,{size:12,className:"animate-spin"}):i.jsx(oe.Save,{size:12})}),i.jsx("button",{onClick:r,disabled:m,className:"inline-editor-btn-modern cancel",title:"Cancel (Escape)",onMouseDown:E=>E.preventDefault(),style:{width:"1.75rem",height:"1.75rem",background:"#ef4444",color:"white",border:"none",borderRadius:"0.375rem",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem"},"aria-label":"Cancel editing",children:i.jsx(oe.X,{size:12})})]})]})},gt=n.memo(pt);function ht(c){const e=window.location.pathname;if(!c)return{path:e,sectionId:0,sectionSelector:"body"};const r=mt(c);return{path:e,sectionId:r.id,sectionSelector:r.selector}}function mt(c){var o;let e=c.parentElement;for(;e&&e.tagName!=="BODY";){if(e.id&&Re(e))return{id:bt(e.id),selector:`#${e.id}`};if(e.hasAttribute("data-section-id")){const l=e.getAttribute("data-section-id");return{id:parseInt(l||"0",10),selector:e.id?`#${e.id}`:`[data-section-id="${l}"]`}}if(Re(e)){const l=Array.from(((o=e.parentElement)==null?void 0:o.children)||[]).indexOf(e);return{id:l+1,selector:`${e.tagName.toLowerCase()}:nth-child(${l+1})`}}e=e.parentElement}return document.querySelector("main")?{id:1,selector:"main"}:{id:0,selector:"body"}}function Re(c){return["SECTION","ARTICLE","MAIN","HEADER","FOOTER","ASIDE"].includes(c.tagName)||c.hasAttribute("data-section")||c.classList.contains("section")}function bt(c){let e=0;for(let r=0;r<c.length;r++){const o=c.charCodeAt(r);e=(e<<5)-e+o,e=e&e}return Math.abs(e)}function xe(c){const e=ht(c);return`${e.path}#${e.sectionSelector}`}const K={colors:{primary:{50:"#eff6ff",100:"#dbeafe"},neutral:{100:"#f3f4f6",200:"#e5e7eb",800:"#1f2937"}},spacing:{xs:"0.25rem",sm:"0.5rem"},borderRadius:{sm:"0.375rem",md:"0.5rem"},shadows:{lg:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)"},typography:{fontSize:{xs:["0.75rem",{lineHeight:"1rem"}]},fontWeight:{medium:"500"}},animation:{duration:{fast:"150ms"},easing:{ease:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0, 0, 0.2, 1)"}}},vt=({children:c,id:e,multiline:r=!0,maxLength:o,placeholder:l,className:u="",as:a="span",showEditableHighlights:m=!1})=>{const{isAuthenticated:f}=ae(),{getContent:d,saveContent:g,isLoading:b}=me(),{error:P,promise:k}=he(),[$,V]=n.useState(!1),[D,z]=n.useState(!1),[v,W]=n.useState(""),[I,G]=n.useState(""),[X,E]=n.useState(""),[y,O]=n.useState(!1),x=n.useRef(null),w=n.useCallback(C=>typeof C=="string"?C:typeof C=="number"?C.toString():C?n.isValidElement(C)&&C.props.children?w(C.props.children):Array.isArray(C)?C.map(w).join(""):"":"",[]);n.useEffect(()=>{if(b||!x.current)return;const C=w(c).trim();E(C);const H=xe(x.current);W(H);const M=d(H,e,C);G(M),O(!0),console.log("[ModernEditableWrapper] Initialized:",{context:H,contextId:e,defaultContent:C,currentContent:M})},[e,c,d,w,b]);const T=n.useCallback(C=>{C.stopPropagation(),f&&!$&&v&&V(!0)},[f,$,v]),h=n.useCallback(async C=>{if(!v)return P("Cannot save: invalid configuration"),!1;const H={content:C,context:v,context_id:e,contentType:"text",lastModified:Date.now()};try{const M=await k(g(H,X),{loading:"Saving changes...",success:"Changes saved successfully!",error:"Failed to save changes"});return M&&(G(C),V(!1)),M}catch(M){return console.error("[ModernEditableWrapper] Save error:",M),!1}},[v,e,g,X,P,k]),R=n.useCallback(()=>{V(!1)},[]);return b||!y?n.createElement(a,{ref:x,className:`modern-editable-skeleton ${u}`,style:{background:`linear-gradient(90deg, ${K.colors.neutral[200]} 25%, ${K.colors.neutral[100]} 50%, ${K.colors.neutral[200]} 75%)`,backgroundSize:"200% 100%",animation:"shimmer 1.5s infinite",borderRadius:K.borderRadius.sm,minHeight:"1.25rem",minWidth:"4rem"}}):$&&f?i.jsx(gt,{content:I,onSave:h,onCancel:R,config:{id:e,multiline:r,maxLength:o,placeholder:l},className:u,as:a,preserveStyles:!0}):i.jsxs(se.motion.div,{style:{position:"relative",display:"inline-block"},onHoverStart:()=>z(!0),onHoverEnd:()=>z(!1),children:[n.createElement(a,{ref:x,className:`modern-editable-wrapper ${f?"is-authenticated":""} ${m?"show-highlights":""} ${u}`,onClick:T,onKeyDown:f?C=>{(C.key==="Enter"||C.key===" ")&&(C.preventDefault(),T(C))}:void 0,style:{position:"relative",cursor:f?"pointer":"default",outline:"none",borderRadius:K.borderRadius.sm,transition:`all ${K.animation.duration.fast} ${K.animation.easing.ease}`,...f&&{outline:"2px solid transparent",outlineOffset:"1px"},...f&&D&&{outline:`2px solid ${K.colors.primary[100]}`,backgroundColor:`${K.colors.primary[50]}`},...m&&f&&{outline:`2px dashed ${K.colors.primary[100]}`,backgroundColor:`${K.colors.primary[50]}`}},title:f?"Click to edit":void 0,"data-context":v,"data-context-id":e,role:f?"button":void 0,tabIndex:f?0:void 0,"aria-label":f?`Edit ${e}`:void 0},I),i.jsx(se.AnimatePresence,{children:f&&D&&!$&&i.jsxs(se.motion.div,{initial:{opacity:0,scale:.8,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.8,y:-10},transition:{duration:.2,ease:K.animation.easing.easeOut},style:{position:"absolute",top:"-2rem",right:"0",background:K.colors.neutral[800],color:"white",padding:`${K.spacing.xs} ${K.spacing.sm}`,borderRadius:K.borderRadius.md,fontSize:K.typography.fontSize.xs[0],fontWeight:K.typography.fontWeight.medium,boxShadow:K.shadows.lg,zIndex:1e3,pointerEvents:"none",whiteSpace:"nowrap"},children:["✏️ Click to edit",i.jsx("div",{style:{position:"absolute",bottom:"-4px",right:"8px",width:"8px",height:"8px",background:K.colors.neutral[800],transform:"rotate(45deg)"}})]})})]})},xt=n.memo(vt),Fe=({showEditableHighlights:c,toggleEditableHighlights:e})=>{const{isAuthenticated:r,logout:o,user:l}=ae(),{success:u,info:a}=he();if(!r)return null;const m=()=>{o(),u("Successfully logged out")},f=()=>{e(),a(c?"Edit highlights hidden":"Edit highlights shown")};return i.jsxs(se.motion.div,{className:"global-editor-toolbar-modern",initial:{opacity:0,y:-20,scale:.9},animate:{opacity:1,y:0,scale:1},transition:{duration:.3,ease:"easeOut"},children:[i.jsxs(se.motion.div,{className:"flex items-center gap-2 px-3 py-2 bg-blue-50 rounded-lg border border-blue-200",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.1},children:[i.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),i.jsx("span",{className:"text-xs font-medium text-blue-800",children:(l==null?void 0:l.name)||"Editor"})]}),i.jsx(se.motion.button,{onClick:f,className:`global-editor-toolbar-btn-modern ${c?"active":""}`,title:c?"Hide editable highlights":"Show editable highlights",whileHover:{scale:1.05},whileTap:{scale:.95},initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.2},children:c?i.jsx(oe.EyeOff,{size:18}):i.jsx(oe.Eye,{size:18})}),i.jsx(se.motion.button,{className:"global-editor-toolbar-btn-modern",title:"Editor settings",whileHover:{scale:1.05},whileTap:{scale:.95},initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.3},onClick:()=>a("Settings panel coming soon"),children:i.jsx(oe.Settings,{size:18})}),i.jsx(se.motion.button,{onClick:m,className:"global-editor-toolbar-btn-modern logout",title:"Logout",whileHover:{scale:1.05},whileTap:{scale:.95},initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.4},children:i.jsx(oe.LogOut,{size:18})})]})};class ce{constructor(e){fe(this,"baseUrl");this.baseUrl=(e||void 0||"https://www.wow.cryptonic-drinks.com").replace(/\/+$/,""),console.log("[MediaUploadService] Initialized with base URL:",this.baseUrl)}async uploadFile(e,r){console.log("[MediaUploadService] Uploading file:",e.name,e.type,e.size);const o=this.validateFile(e);if(!o.valid)return{success:!1,error:o.error};const l=ie.get();if(!l)return{success:!1,error:"Authentication required"};const u=new FormData;u.append("file",e),u.append("title",e.name.replace(/\.[^/.]+$/,"")),u.append("alt",e.name.replace(/\.[^/.]+$/,""));try{const a=new XMLHttpRequest,m=new Promise((f,d)=>{a.onload=()=>{if(a.status>=200&&a.status<300)try{const g=JSON.parse(a.responseText);console.log("[MediaUploadService] Upload successful:",g),f(this.formatResponse(g))}catch{d(new Error("Invalid response format"))}else d(new Error(`Upload failed: ${a.status} ${a.statusText}`))},a.onerror=()=>d(new Error("Network error")),a.onabort=()=>d(new Error("Upload cancelled"))});return r&&(a.upload.onprogress=f=>{f.lengthComputable&&r({loaded:f.loaded,total:f.total,percentage:Math.round(f.loaded/f.total*100)})}),a.open("POST",`${this.baseUrl}/wp-json/wp/v2/media`),a.setRequestHeader("Authorization",`Bearer ${l}`),a.send(u),await m}catch(a){return console.error("[MediaUploadService] Upload error:",a),{success:!1,error:a instanceof Error?a.message:"Upload failed"}}}async uploadFromUrl(e,r){console.log("[MediaUploadService] Uploading from URL:",e);const o=this.validateUrl(e);if(!o.valid)return{success:!1,error:o.error};const l=ie.get();if(!l)return{success:!1,error:"Authentication required"};try{const u=await fetch(`${this.baseUrl}/wp-json/api/media/import-url`,{method:"POST",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:JSON.stringify({url:e,filename:r||this.extractFilenameFromUrl(e),title:(r==null?void 0:r.replace(/\.[^/.]+$/,""))||"Imported image",alt:(r==null?void 0:r.replace(/\.[^/.]+$/,""))||"Imported image"})});if(!u.ok){const m=await u.text();throw new Error(`Import failed: ${u.status} - ${m}`)}const a=await u.json();return console.log("[MediaUploadService] URL import successful:",a),this.formatResponse(a)}catch(u){return console.error("[MediaUploadService] URL import error:",u),{success:!1,error:u instanceof Error?u.message:"Import failed"}}}async deleteMedia(e){const r=ie.get();if(!r)return console.error("[MediaUploadService] No token for deletion"),!1;try{return(await fetch(`${this.baseUrl}/wp-json/wp/v2/media/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${r}`}})).ok}catch(o){return console.error("[MediaUploadService] Delete error:",o),!1}}async getMediaDetails(e){try{const r=await fetch(`${this.baseUrl}/wp-json/wp/v2/media/${e}`);if(!r.ok)throw new Error("Media not found");return await r.json()}catch(r){return console.error("[MediaUploadService] Get media error:",r),null}}validateFile(e){const r=["image/jpeg","image/jpg","image/png","image/gif","image/webp","image/svg+xml"];if(!r.includes(e.type))return{valid:!1,error:`Type de fichier non supporté. Formats acceptés: ${r.join(", ")}`};const o=10*1024*1024;return e.size>o?{valid:!1,error:`Fichier trop volumineux. Taille maximale: ${o/1024/1024}MB`}:{valid:!0}}validateUrl(e){try{const r=new URL(e);if(!["http:","https:"].includes(r.protocol))return{valid:!1,error:"URL invalide. Utilisez http:// ou https://"};const o=r.pathname.toLowerCase();return![".jpg",".jpeg",".png",".gif",".webp",".svg"].some(a=>o.endsWith(a))&&!o.includes("image")&&console.warn("[MediaUploadService] URL might not be an image:",e),{valid:!0}}catch{return{valid:!1,error:"URL invalide"}}}extractFilenameFromUrl(e){try{const o=new URL(e).pathname,l=o.substring(o.lastIndexOf("/")+1);return!l||l===""?`image-${Date.now()}.jpg`:l.includes(".")?l:`${l}.jpg`}catch{return`image-${Date.now()}.jpg`}}formatResponse(e){var l,u,a,m,f,d,g;if(!e||!e.id&&!e.ID)return{success:!1,error:"Invalid response from server"};const r=e.id||e.ID,o=e.source_url||((l=e.guid)==null?void 0:l.rendered)||e.url;return{success:!0,data:{id:r,url:o,alt:e.alt_text||"",title:((u=e.title)==null?void 0:u.rendered)||e.title||"",sizes:(a=e.media_details)!=null&&a.sizes?{thumbnail:(m=e.media_details.sizes.thumbnail)==null?void 0:m.source_url,medium:(f=e.media_details.sizes.medium)==null?void 0:f.source_url,large:(d=e.media_details.sizes.large)==null?void 0:d.source_url,full:((g=e.media_details.sizes.full)==null?void 0:g.source_url)||o}:void 0}}}static createPreviewUrl(e){return URL.createObjectURL(e)}static revokePreviewUrl(e){URL.revokeObjectURL(e)}static isUrl(e){try{return new URL(e),!0}catch{return e.startsWith("/")||e.startsWith("./")||e.startsWith("../")}}}const Ne=({isOpen:c,onClose:e,onImageSelected:r})=>{const[o,l]=n.useState("file"),[u,a]=n.useState(!1),[m,f]=n.useState(null),[d,g]=n.useState(""),[b,P]=n.useState(""),[k,$]=n.useState(!1),[V,D]=n.useState(0),[z,v]=n.useState(""),W=n.useRef(null),I=n.useRef(new ce).current;n.useEffect(()=>()=>{d&&!ce.isUrl(d)&&ce.revokePreviewUrl(d)},[d]);const G=n.useCallback(h=>{h.preventDefault(),a(!0)},[]),X=n.useCallback(h=>{h.preventDefault(),a(!1)},[]),E=n.useCallback(h=>{h.preventDefault(),a(!1);const C=Array.from(h.dataTransfer.files).find(H=>H.type.startsWith("image/"));C?y(C):v("Veuillez déposer une image")},[]),y=n.useCallback(h=>{f(h),v(""),d&&!ce.isUrl(d)&&ce.revokePreviewUrl(d);const R=ce.createPreviewUrl(h);g(R)},[d]),O=n.useCallback(async()=>{if(!m){v("Aucun fichier sélectionné");return}$(!0),v(""),D(0);try{const h=await I.uploadFile(m,R=>{D(R.percentage)});h.success&&h.data?(r(h.data.url),e()):v(h.error||"Échec de l'upload")}catch(h){v("Erreur lors de l'upload"),console.error("[ImageUploadModal] Upload error:",h)}finally{$(!1),D(0)}},[m,I,r,e]),x=n.useCallback(async()=>{if(!b.trim()){v("Veuillez entrer une URL");return}$(!0),v("");try{const h=await I.uploadFromUrl(b);h.success&&h.data?(r(h.data.url),e()):v(h.error||"Échec de l'import")}catch(h){v("Erreur lors de l'import"),console.error("[ImageUploadModal] Import error:",h)}finally{$(!1)}},[b,I,r,e]),w=n.useCallback(()=>{if(!b.trim()){v("Veuillez entrer une URL");return}r(b),e()},[b,r,e]),T=n.useCallback(()=>{f(null),g(""),P(""),v(""),l("file"),e()},[e]);return c?i.jsx("div",{className:"image-upload-modal-overlay",onClick:T,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:i.jsxs("div",{className:"image-upload-modal",onClick:h=>h.stopPropagation(),style:{background:"#1f2937",borderRadius:"12px",padding:"24px",maxWidth:"600px",width:"90%",maxHeight:"90vh",overflow:"auto",color:"white"},children:[i.jsx("h2",{style:{margin:"0 0 20px 0",fontSize:"24px"},children:"Modifier l'image"}),i.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"24px"},children:[i.jsx("button",{onClick:()=>l("file"),style:{flex:1,padding:"12px",background:o==="file"?"#3b82f6":"#374151",border:"none",borderRadius:"6px",color:"white",cursor:"pointer",fontSize:"16px",transition:"background 0.2s"},children:"📤 Upload un fichier"}),i.jsx("button",{onClick:()=>l("url"),style:{flex:1,padding:"12px",background:o==="url"?"#3b82f6":"#374151",border:"none",borderRadius:"6px",color:"white",cursor:"pointer",fontSize:"16px",transition:"background 0.2s"},children:"🔗 Depuis une URL"})]}),o==="file"&&i.jsxs("div",{children:[i.jsx("div",{onDragOver:G,onDragLeave:X,onDrop:E,onClick:()=>{var h;return(h=W.current)==null?void 0:h.click()},style:{border:`2px dashed ${u?"#3b82f6":"#6b7280"}`,borderRadius:"8px",padding:"40px",textAlign:"center",cursor:"pointer",background:u?"rgba(59, 130, 246, 0.1)":"rgba(55, 65, 81, 0.5)",transition:"all 0.2s"},children:m?i.jsxs("div",{children:[d&&i.jsx("img",{src:d,alt:"Preview",style:{maxWidth:"300px",maxHeight:"200px",objectFit:"contain",margin:"0 auto 16px"}}),i.jsx("p",{style:{margin:"8px 0",fontSize:"14px"},children:m.name}),i.jsxs("p",{style:{margin:"0",fontSize:"12px",color:"#9ca3af"},children:[(m.size/1024/1024).toFixed(2)," MB"]})]}):i.jsxs(i.Fragment,{children:[i.jsx("p",{style:{margin:"0 0 8px 0",fontSize:"18px"},children:"📁 Glissez une image ici"}),i.jsx("p",{style:{margin:"0",fontSize:"14px",color:"#9ca3af"},children:"ou cliquez pour sélectionner"})]})}),i.jsx("input",{ref:W,type:"file",accept:"image/*",onChange:h=>{var C;const R=(C=h.target.files)==null?void 0:C[0];R&&y(R)},style:{display:"none"}}),k&&V>0&&i.jsxs("div",{style:{marginTop:"16px"},children:[i.jsx("div",{style:{background:"#374151",borderRadius:"4px",height:"8px",overflow:"hidden"},children:i.jsx("div",{style:{background:"#3b82f6",height:"100%",width:`${V}%`,transition:"width 0.3s"}})}),i.jsxs("p",{style:{textAlign:"center",marginTop:"8px",fontSize:"14px",color:"#9ca3af"},children:[V,"%"]})]})]}),o==="url"&&i.jsxs("div",{children:[i.jsx("input",{type:"text",value:b,onChange:h=>P(h.target.value),placeholder:"https://example.com/image.jpg",style:{width:"100%",padding:"12px",background:"#374151",border:"1px solid #6b7280",borderRadius:"6px",color:"white",fontSize:"16px"}}),i.jsxs("div",{style:{marginTop:"12px",padding:"12px",background:"rgba(59, 130, 246, 0.1)",borderRadius:"6px",fontSize:"14px"},children:[i.jsx("p",{style:{margin:"0 0 8px 0"},children:"💡 Deux options disponibles :"}),i.jsxs("ul",{style:{margin:"0",paddingLeft:"20px"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Importer dans WordPress"})," : L'image sera téléchargée et stockée dans votre médiathèque"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Utiliser l'URL directement"})," : L'image restera hébergée sur le site externe"]})]})]})]}),z&&i.jsxs("div",{style:{marginTop:"16px",padding:"12px",background:"rgba(239, 68, 68, 0.1)",border:"1px solid #ef4444",borderRadius:"6px",color:"#ef4444",fontSize:"14px"},children:["⚠️ ",z]}),i.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"24px",justifyContent:"flex-end"},children:[i.jsx("button",{onClick:T,disabled:k,style:{padding:"10px 20px",background:"#6b7280",border:"none",borderRadius:"6px",color:"white",cursor:k?"not-allowed":"pointer",fontSize:"16px",opacity:k?.5:1},children:"Annuler"}),o==="file"&&i.jsx("button",{onClick:O,disabled:!m||k,style:{padding:"10px 20px",background:"#10b981",border:"none",borderRadius:"6px",color:"white",cursor:!m||k?"not-allowed":"pointer",fontSize:"16px",opacity:!m||k?.5:1},children:k?"Upload...":"Uploader"}),o==="url"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:w,disabled:!b.trim()||k,style:{padding:"10px 20px",background:"#3b82f6",border:"none",borderRadius:"6px",color:"white",cursor:!b.trim()||k?"not-allowed":"pointer",fontSize:"16px",opacity:!b.trim()||k?.5:1},children:"Utiliser l'URL"}),i.jsx("button",{onClick:x,disabled:!b.trim()||k,style:{padding:"10px 20px",background:"#10b981",border:"none",borderRadius:"6px",color:"white",cursor:!b.trim()||k?"not-allowed":"pointer",fontSize:"16px",opacity:!b.trim()||k?.5:1},children:k?"Import...":"Importer dans WP"})]})]})]})}):null},yt=({id:c,src:e,alt:r="",className:o="",style:l={},width:u,height:a,loading:m="lazy",showEditableHighlights:f=!1})=>{const{isAuthenticated:d}=ae(),{getContent:g,saveContent:b,isLoading:P}=me(),[k,$]=n.useState(""),[V,D]=n.useState(""),[z,v]=n.useState(!1),[W,I]=n.useState(!1),G=n.useRef(null);n.useEffect(()=>{if(P||!G.current)return;const y=xe(G.current);$(y);const O=g(y,c,e);D(O),v(!0),console.log("[ModernEditableImage] Initialized:",{context:y,contextId:c,defaultSrc:e,savedSrc:O})},[c,e,g,P]);const X=n.useCallback(()=>{d&&k&&I(!0)},[d,k]),E=n.useCallback(async y=>{if(k){try{const O={content:y,context:k,context_id:c,contentType:"text",lastModified:Date.now()};await b(O,e)?(D(y),console.log(`[ModernEditableImage] Image source saved for ${c}`)):console.error(`[ModernEditableImage] Failed to save image source for ${c}`)}catch(O){console.error("[ModernEditableImage] Error saving image:",O)}I(!1)}},[k,c,b,e]);return P||!z?i.jsx("div",{className:`editable-image-skeleton ${o}`,style:{...l,width:u||"100%",height:a||"200px",background:"linear-gradient(90deg, #e5e7eb 25%, #f3f4f6 50%, #e5e7eb 75%)",backgroundSize:"200% 100%",animation:"shimmer 1.5s infinite",borderRadius:"0.375rem"}}):i.jsxs(i.Fragment,{children:[i.jsx("img",{ref:G,src:V,alt:r,width:u,height:a,loading:m,className:`editable-image-seamless ${d?"is-authenticated":""} ${f?"editable-highlight":""} ${o}`,style:{...l,cursor:d?"pointer":"default",transition:"outline-color 150ms ease",outline:"2px solid transparent",outlineOffset:"1px",...d&&{":hover":{outlineColor:"rgba(59, 130, 246, 0.3)"}},...f&&d&&{outlineColor:"rgba(59, 130, 246, 0.3)",outlineStyle:"dashed"}},onClick:X,title:d?"Click to change image":void 0,"data-context":k,"data-context-id":c,role:d?"button":void 0,tabIndex:d?0:void 0,"aria-label":d?`Edit image: ${r||c}`:r,onKeyDown:d?y=>{(y.key==="Enter"||y.key===" ")&&(y.preventDefault(),X())}:void 0}),i.jsx(Ne,{isOpen:W,onClose:()=>I(!1),onImageSelected:E})]})},wt=n.memo(yt),Et=({children:c,backgroundImage:e,id:r,className:o="",style:l={},as:u="div",showEditableHighlights:a=!1})=>{const{isAuthenticated:m}=ae(),{getContent:f,saveContent:d,isLoading:g}=me(),[b,P]=n.useState(!1),[k,$]=n.useState(""),[V,D]=n.useState(""),[z,v]=n.useState(""),[W,I]=n.useState(!1),[G,X]=n.useState(!1),[E,y]=n.useState(!1),O=n.useRef(null),x=n.useRef(null),w=n.useCallback(S=>{const B=S.match(/url\(['"]?([^'"]+)['"]?\)/);return B?B[1]:S},[]),T=n.useCallback(S=>!S||S==="none"?"none":`url('${S}')`,[]);n.useEffect(()=>{if(g||!O.current)return;const S=xe(O.current);$(S);const B=w(e),re=f(S,r,B);D(re),X(!0),console.log("[EditableBackground] Initialized:",{context:S,contextId:r,defaultUrl:B,savedUrl:re})},[r,e,f,g,w]);const h=()=>i.jsx("button",{onClick:R,className:"editable-background-edit-btn",style:{position:"absolute",top:"8px",right:"8px",width:"32px",height:"32px",background:"rgba(0, 0, 0, 0.8)",color:"white",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px",zIndex:10,transition:"all 0.2s ease",opacity:a?1:0},title:"Modifier l'image de fond",onMouseEnter:S=>{S.currentTarget.style.opacity="1"},onMouseLeave:S=>{S.currentTarget.style.opacity=a?"1":"0"},children:"🖼️"}),R=n.useCallback(()=>{m&&!b&&k&&(P(!0),v(V),y(!1),setTimeout(()=>{var S,B;(S=x.current)==null||S.focus(),(B=x.current)==null||B.select()},0))},[m,b,k,V]),C=n.useCallback(S=>{v(S),y(!1)},[]),H=n.useCallback(async S=>!S||S==="none"?!0:new Promise(B=>{const re=new Image;re.onload=()=>B(!0),re.onerror=()=>B(!1),re.src=S}),[]),M=n.useCallback(async()=>{if(!k||W)return;const S=z.trim()||"none";if(S!=="none"){try{new URL(S,window.location.href)}catch{if(!S.startsWith("/")&&!S.startsWith("./")&&!S.startsWith("../")){alert('URL invalide. Utilisez une URL complète, un chemin relatif valide, ou "none".');return}}if(!await H(S)&&!window.confirm("L'image ne semble pas se charger correctement. Voulez-vous quand même sauvegarder cette URL ?"))return}I(!0);try{const B={content:S,context:k,context_id:r,contentType:"text",lastModified:Date.now()},re=w(e);await d(B,re)?(D(S),P(!1),console.log(`[EditableBackground] Background URL saved for ${r}`)):console.error(`[EditableBackground] Failed to save background URL for ${r}`)}finally{I(!1)}},[k,z,W,r,d,e,w,H]),U=n.useCallback(()=>{v(V),P(!1)},[V]),q=n.useCallback(S=>{S.key==="Escape"?(S.preventDefault(),U()):S.key==="Enter"&&(S.preventDefault(),M())},[U,M]),Z={...l,backgroundImage:T(b?z:V),position:"relative",transition:"all 0.2s ease"};return g||!G?n.createElement(u,{ref:O,className:o,style:{...l,visibility:"hidden"}},c):n.createElement(u,{ref:O,className:`editable-background ${m?"is-authenticated":""} ${a&&m?"editable-highlight":""} ${o}`,style:Z,"data-context":k,"data-context-id":r,onMouseEnter:S=>{if(m&&!b){const B=S.currentTarget.querySelector(".editable-background-edit-btn");B&&(B.style.opacity="1")}},onMouseLeave:S=>{if(m&&!b&&!a){const B=S.currentTarget.querySelector(".editable-background-edit-btn");B&&(B.style.opacity="0")}}},i.jsxs(i.Fragment,{children:[c,m&&!b&&i.jsx(h,{}),b&&m&&i.jsxs("div",{className:"editable-background-editor",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(0, 0, 0, 0.95)",padding:"16px",borderRadius:"8px",minWidth:"300px",maxWidth:"90%",zIndex:1e3,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.5)"},children:[i.jsx("h4",{style:{margin:"0 0 12px 0",color:"white",fontSize:"16px"},children:"Modifier l'image de fond"}),i.jsxs("div",{style:{display:"flex",gap:"8px"},children:[i.jsx("input",{ref:x,type:"text",value:z,onChange:S=>v(S.target.value),onKeyDown:q,placeholder:"URL de l'image ou 'none'",style:{flex:1,padding:"8px 12px",border:"1px solid rgba(255, 255, 255, 0.3)",background:"rgba(255, 255, 255, 0.1)",color:"white",borderRadius:"4px",fontSize:"14px"},disabled:W}),i.jsx("button",{onClick:()=>y(!0),disabled:W,style:{padding:"8px 16px",background:"#3b82f6",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"14px",fontWeight:"500"},title:"Uploader une image",children:"📤"}),i.jsx("button",{onClick:M,disabled:W,style:{padding:"8px 16px",background:"#10b981",color:"white",border:"none",borderRadius:"4px",cursor:W?"not-allowed":"pointer",opacity:W?.6:1,fontSize:"14px",fontWeight:"500"},children:W?"Saving...":"Save"}),i.jsx("button",{onClick:U,disabled:W,style:{padding:"8px 16px",background:"#ef4444",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:"Cancel"})]}),i.jsx("div",{style:{marginTop:"8px",fontSize:"12px",color:"rgba(255, 255, 255, 0.6)"},children:"Exemples : https://example.com/image.jpg, /images/hero.jpg, none"})]}),i.jsx(Ne,{isOpen:E,onClose:()=>y(!1),onImageSelected:C})]}))},Ct=n.memo(Et),St=({children:c,id:e,attribute:r,defaultValue:o,validator:l,transformer:u,showEditableHighlights:a=!1,editLabel:m})=>{const{isAuthenticated:f}=ae(),{getContent:d,saveContent:g,isLoading:b}=me(),[P,k]=n.useState(!1),[$,V]=n.useState(""),[D,z]=n.useState(""),[v,W]=n.useState(""),[I,G]=n.useState(!1),[X,E]=n.useState(!1),[y,O]=n.useState(""),x=n.useRef(null),w=n.useRef(null);n.useEffect(()=>{if(b||!x.current)return;const U=xe(x.current);V(U);const q=`${e}-${r}`,Z=d(U,q,o);z(Z),E(!0),console.log("[EditableAttribute] Initialized:",{context:U,contextId:q,attribute:r,defaultValue:o,savedValue:Z})},[e,r,o,d,b]);const T=n.useCallback(U=>{U.preventDefault(),U.stopPropagation(),f&&!P&&$&&(k(!0),W(D),O(""),setTimeout(()=>{var q,Z;(q=w.current)==null||q.focus(),(Z=w.current)==null||Z.select()},0))},[f,P,$,D]),h=n.useCallback(U=>{if(!l)return!0;const q=l(U);return typeof q=="string"?(O(q),!1):(O(""),q)},[l]),R=n.useCallback(async()=>{if(!$||I||!h(v))return;const U=u?u(v):v;G(!0);try{const q=`${e}-${r}`,Z={content:U,context:$,context_id:q,contentType:"text",lastModified:Date.now()};await g(Z,o)?(z(U),k(!1),console.log(`[EditableAttribute] Attribute ${r} saved for ${e}`)):console.error(`[EditableAttribute] Failed to save attribute ${r} for ${e}`)}finally{G(!1)}},[$,v,I,e,r,g,o,h,u]),C=n.useCallback(()=>{W(D),k(!1),O("")},[D]),H=n.useCallback(U=>{U.key==="Escape"?(U.preventDefault(),C()):U.key==="Enter"&&(U.preventDefault(),R())},[C,R]);if(b||!X)return n.cloneElement(c,{ref:x});const M=n.cloneElement(c,{ref:x,[r]:D,className:`${c.props.className||""} editable-attribute ${f?"is-authenticated":""} ${a?"editable-highlight":""}`.trim(),"data-context":$,"data-context-id":`${e}-${r}`,"data-editable-attribute":r});return i.jsxs("div",{style:{position:"relative",display:"inline-block"},children:[M,f&&!P&&i.jsxs("span",{className:"editable-attribute-indicator",onClick:T,style:{cursor:"pointer"},children:["✏️ ",m||r]}),P&&f&&i.jsxs("div",{className:"editable-attribute-editor",style:{position:"absolute",top:"100%",left:0,marginTop:"8px",background:"rgba(0, 0, 0, 0.95)",padding:"12px",borderRadius:"6px",minWidth:"250px",zIndex:1e3,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"white",fontSize:"13px",fontWeight:"500"},children:m||`Edit ${r}`}),i.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:y?"8px":0},children:[i.jsx("input",{ref:w,type:"text",value:v,onChange:U=>{W(U.target.value),h(U.target.value)},onKeyDown:H,style:{flex:1,padding:"6px 10px",border:`1px solid ${y?"#ef4444":"rgba(255, 255, 255, 0.3)"}`,background:"rgba(255, 255, 255, 0.1)",color:"white",borderRadius:"4px",fontSize:"13px"},disabled:I}),i.jsx("button",{onClick:R,disabled:I||!!y,style:{padding:"6px 12px",background:y?"#6b7280":"#10b981",color:"white",border:"none",borderRadius:"4px",cursor:I||y?"not-allowed":"pointer",opacity:I||y?.6:1,fontSize:"13px"},children:"✓"}),i.jsx("button",{onClick:C,disabled:I,style:{padding:"6px 12px",background:"#ef4444",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"13px"},children:"✕"})]}),y&&i.jsx("div",{style:{color:"#ef4444",fontSize:"12px",marginTop:"-4px"},children:y})]})]})},kt=n.memo(St),We=({children:c,useModernDesign:e=!0})=>{const[r,o]=n.useState(!1),l=()=>{o(u=>!u)};return n.useEffect(()=>{const u=document.body;return r?u.classList.add("editable-highlight-active"):u.classList.remove("editable-highlight-active"),()=>{u.classList.remove("editable-highlight-active")}},[r]),n.useEffect(()=>{const u=document.body;return e?u.classList.add("inline-editor-modern"):u.classList.remove("inline-editor-modern"),()=>{u.classList.remove("inline-editor-modern")}},[e]),i.jsx(Ve.Provider,{value:{showEditableHighlights:r},children:i.jsx(ct,{children:i.jsx(lt,{children:i.jsxs(dt,{children:[c,i.jsx(Fe,{showEditableHighlights:r,toggleEditableHighlights:l}),i.jsx(ft,{})]})})})})},Ve=n.createContext({showEditableHighlights:!1}),jt=()=>n.useContext(Ve).showEditableHighlights;N.EditableAttribute=kt,N.EditableBackground=Ct,N.InlineEditor=We,N.ModernEditableImage=wt,N.ModernEditableWrapper=xt,N.ModernEditorToolbar=Fe,N.default=We,N.useAuth=ae,N.useContent=me,N.useEditableHighlights=jt,N.useNotifications=he,Object.defineProperties(N,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
